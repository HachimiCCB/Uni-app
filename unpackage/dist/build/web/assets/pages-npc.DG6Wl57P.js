var t,l;import{o as a,c as s,w as e,a as o,r as i,n as r,i as c,S as n,b as d,d as u,g as h,e as v,f as _,F as p,h as f,j as m,k as g,l as y,p as w,t as b,m as x,s as W,q as S}from"./index-GtydPhVv.js";import{m as k,a as C,_ as $,o as j,b as E,r as T}from"./uv-safe-bottom.DWGvcUcV.js";import{t as B}from"./tabBar.C1GSFUni.js";import{i as I}from"./common.CRQQSQR3.js";const L={props:{indicatorWidth:{type:[String,Number],default:50},indicatorBarWidth:{type:[String,Number],default:20},indicator:{type:Boolean,default:!0},indicatorColor:{type:String,default:"#f2f2f2"},indicatorActiveColor:{type:String,default:"#3c9cff"},indicatorStyle:{type:[String,Object],default:""},...null==(l=null==(t=uni.$uv)?void 0:t.props)?void 0:l.scrollList}};function N(t,l,a){t.selectComponent(".uv-scroll-list__indicator__line__bar")&&t.selectComponent(".uv-scroll-list__indicator__line__bar").setStyle({transform:"rpx"==a?"translateX("+l+"rpx)":"translateX("+l+"px)"})}const A={scroll:function(t,l){var a=t.detail,s=a.scrollWidth,e=a.scrollLeft,o=t.currentTarget.dataset;N(l,e/(s-(o.scrollWidth||o.scrollwidth||0))*((o.indicatorWidth||o.indicatorwidth||0)-(o.barWidth||o.barwidth||0)),o.unit)},scrolltolower:function(t,l){l.callMethod("scrollEvent","right");var a=t.currentTarget.dataset;N(l,(a.indicatorWidth||a.indicatorwidth||0)-(a.barWidth||a.barwidth||0),a.unit)},scrolltoupper:function(t,l){var a=t.currentTarget.dataset;l.callMethod("scrollEvent","left"),N(l,0,a.unit)}},D=t=>{t.$wxs||(t.$wxs=[]),t.$wxs.push("wxs"),t.mixins||(t.mixins=[]),t.mixins.push({beforeCreate(){this.wxs=A}})},F={name:"uv-scroll-list",mixins:[k,C,L],data:()=>({scrollInfo:{scrollLeft:0,scrollWidth:0},scrollWidth:0}),computed:{barStyle(){const t={};return t.width=this.$uv.addUnit(this.indicatorBarWidth),t.backgroundColor=this.indicatorActiveColor,t},lineStyle(){const t={};return t.width=this.$uv.addUnit(this.indicatorWidth),t.backgroundColor=this.indicatorColor,t}},mounted(){this.init()},methods:{init(){this.getComponentWidth()},scrollEvent(t){this.$emit(t)},async getComponentWidth(){await this.$uv.sleep(30),this.$uvGetRect(".uv-scroll-list").then((t=>{this.scrollWidth=t.width}))}}};D(F);const M=$(F,[["render",function(t,l,d,u,h,v){const _=c,p=n;return a(),s(_,{class:"uv-scroll-list",ref:"uv-scroll-list"},{default:e((()=>[o(p,{class:"uv-scroll-list__scroll-view","scroll-x":"",onScroll:t.wxs.scroll,onScrolltoupper:t.wxs.scrolltoupper,onScrolltolower:t.wxs.scrolltolower,"data-scrollWidth":h.scrollWidth,"data-barWidth":t.$uv.getPx(t.indicatorBarWidth),"data-indicatorWidth":t.$uv.getPx(t.indicatorWidth),"show-scrollbar":!1,"upper-threshold":0,"lower-threshold":0,"data-unit":t.$uv.unit},{default:e((()=>[o(_,{class:"uv-scroll-list__scroll-view__content"},{default:e((()=>[i(t.$slots,"default",{},void 0,!0)])),_:3})])),_:3},8,["onScroll","onScrolltoupper","onScrolltolower","data-scrollWidth","data-barWidth","data-indicatorWidth","data-unit"]),t.indicator?(a(),s(_,{key:0,class:"uv-scroll-list__indicator",style:r([t.$uv.addStyle(t.indicatorStyle)])},{default:e((()=>[o(_,{class:"uv-scroll-list__indicator__line",style:r([v.lineStyle])},{default:e((()=>[o(_,{class:"uv-scroll-list__indicator__line__bar",style:r([v.barStyle]),ref:"uv-scroll-list__indicator__line__bar"},null,8,["style"])])),_:1},8,["style"])])),_:1},8,["style"])):(a(),s(_,{key:1,class:"uv-scroll-list__indicator__line__bar"}))])),_:3},512)}],["__scopeId","data-v-0738e35e"]]),P=$({__name:"npc",emits:["openItem"],setup(t,{emit:l}){const i=d("");u((()=>{i.value=f().windowHeight})),j((()=>{}));I();const n=d(h("locationData")),k=d(h("npcData"));d(!0);const C=d(new Set),$=d([]),L=t=>{if("全部"!==t){if(C.value.has(t))return C.value.delete(t),C.value.clear(),C.value.add("全部"),void($.value=k.value);C.value.clear(),C.value.add(t),$.value=k.value.filter((t=>{let l=t.location.split(","),a=[...C.value].concat();return l.forEach((t=>{a=a.filter((l=>l!==t.trim()))})),0===a.length}))}else C.value.clear(),C.value.add(t),$.value=k.value};L("全部");const N=d(!1);E((t=>{t.scrollTop>=300?N.value=!0:N.value=!1}));const A=()=>{w({scrollTop:0,duration:150})};return(t,l)=>{const d=c,u=T(v("uv-scroll-list"),M);return a(),_(p,null,[o(d,{class:"npc",style:r({height:i.value-44+"px"})},{default:e((()=>[o(d,{class:"tag-filter"},{default:e((()=>[o(d,{class:"touhou-tag",onClick:l[0]||(l[0]=t=>L("全部"))},{default:e((()=>[m(" 全部 "),C.value.has("全部")?(a(),s(d,{key:0,class:"touhou-tag-select"})):g("",!0)])),_:1}),o(u,{class:"tag-scroll",indicator:!1},{default:e((()=>[(a(!0),_(p,null,y(n.value,(t=>(a(),s(d,{class:"touhou-tag",key:t,onClick:l=>L(t)},{default:e((()=>[m(b(t)+" ",1),C.value.has(t)?(a(),s(d,{key:0,class:"touhou-tag-select"})):g("",!0)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1}),o(d,{class:"npc-area"},{default:e((()=>[o(d,{class:"npc-area-img",style:r({height:i.value-95+"px"})},{default:e((()=>[(a(!0),_(p,null,y($.value,((t,l)=>(a(),s(d,{class:"npc-img",key:t.name,onClick:l=>(W("selectNpc",t),void S({url:"/pages/npcItem"}))},{default:e((()=>[x("img",{src:"/static/img/npc/"+t.name+".png",style:{width:"76px",height:"100px"},mode:"scaleToFill",onError:t=>{}},null,40,["src","onError"])])),_:2},1032,["onClick"])))),128))])),_:1},8,["style"])])),_:1}),N.value?(a(),s(d,{key:0,class:"top-back",onClick:A},{default:e((()=>[o(d,{class:"arrow"}),o(d,{class:"stick"})])),_:1})):g("",!0)])),_:1},8,["style"]),o(B,{selected:0})],64)}}},[["__scopeId","data-v-a1adc2ba"]]);export{P as default};
