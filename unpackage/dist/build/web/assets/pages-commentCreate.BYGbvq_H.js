import{r as e,_ as a,a as l,h as s,w as t,i as o,o as c,b as u,c as n,k as i,F as d,f as r,j as p,a0 as m,a1 as f,a2 as v,a3 as _,a4 as b,H as h,a5 as y,D as k,N as g,G as C,a6 as j,E as x}from"./index-yJ4PhItL.js";import{_ as F}from"./uni-icons.n_uTH-bD.js";import{r as z}from"./uni-app.es.B94_6v_V.js";import{_ as P}from"./_plugin-vue_export-helper.BCo6x5W8.js";const T=P({__name:"commentCreate",setup(P){const T=e(""),V=e([]),w=a.database(),B=()=>{m({count:3-V.value.length,sizeType:["compressed"],sourceType:["album","camera"],success:e=>{V.value=V.value.concat(e.tempFilePaths)}})},D=()=>{T.value.trim()?(v({title:"提交中..."}),setTimeout((()=>{w.collection("comment").add({user_id:"client_test",content:T.value}),_(),f({title:"提交成功",icon:"success"}),T.value="",V.value=[]}),1500)):f({title:"请输入评论内容",icon:"none"})},A=()=>{if(0===V.value.length)return void f({title:"请先选择图片",icon:"none"});const e=V.value[0];a.uploadFile({filePath:e,cloudPath:"test_"+Date.now()+".png"}).then((e=>{console.log(e)}))},E=()=>{T.value.trim()||V.value.length>0?b({title:"提示",content:"确定取消编辑吗？",success:e=>{e.confirm&&(T.value="",V.value=[])}}):h()};return(e,a)=>{const m=y,f=x,v=z(l("uni-icons"),F),_=o,h=k,P=g;return c(),s(_,{class:"container"},{default:t((()=>[u(m,{modelValue:T.value,"onUpdate:modelValue":a[0]||(a[0]=e=>T.value=e),placeholder:"请输入评论内容...",class:"textarea","placeholder-class":"placeholder-style"},null,8,["modelValue"]),u(_,{class:"upload-area"},{default:t((()=>[(c(!0),n(d,null,i(V.value,((e,a)=>(c(),s(_,{class:"upload-item",key:a,onClick:e=>(e=>{j({current:e,urls:V.value})})(a)},{default:t((()=>[u(f,{src:e,class:"uploaded-image",mode:"aspectFill"},null,8,["src"]),u(_,{class:"delete-icon",onClick:C((e=>(e=>{b({title:"提示",content:"确定删除这张图片吗？",success:a=>{a.confirm&&V.value.splice(e,1)}})})(a)),["stop"])},{default:t((()=>[u(v,{type:"closeempty",size:"18",color:"#fff"})])),_:2},1032,["onClick"])])),_:2},1032,["onClick"])))),128)),V.value.length<3?(c(),s(_,{key:0,class:"upload-btn",onClick:B},{default:t((()=>[u(v,{type:"plusempty",size:"40",color:"#8B5A2B"}),u(h,{class:"upload-tip"},{default:t((()=>[r("最多3张")])),_:1})])),_:1})):p("",!0)])),_:1}),u(_,{class:"button-group"},{default:t((()=>[u(P,{type:"default",onClick:D,disabled:!T.value.trim(),class:"submit-btn"},{default:t((()=>[r("提交")])),_:1},8,["disabled"]),u(P,{type:"default",onClick:A,disabled:!T.value.trim(),class:"submit-btn"},{default:t((()=>[r("图片测试")])),_:1},8,["disabled"]),u(P,{type:"default",onClick:E,class:"cancel-btn"},{default:t((()=>[r("取消")])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-f4357473"]]);export{T as default};
