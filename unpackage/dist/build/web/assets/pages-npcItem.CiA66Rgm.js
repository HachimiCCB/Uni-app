var t,e;import{u as a,v as i,x as l,o as s,c as r,i as o,y as n,z as u,A as d,B as c,p as h,w as p,r as g,e as f,a as v,n as _,f as m,F as b,l as y,C as S,j as w,t as k,D as x,S as $,b as C,d as T,g as B,h as N,E as z,G as R,H as D,I as L,k as F}from"./index-GtydPhVv.js";import{_ as P,m as A,a as I,u as j,r as W,c as M}from"./uv-safe-bottom.DWGvcUcV.js";import{c as O}from"./cookBar.D5kG847u.js";import"./uv-modal.MWfePgvv.js";import"./uv-modal.vue_vue_type_style_index_0_scoped_6a64dca2_lang.D1XXXXMA.js";/* empty css                                                                */const E=P({props:{title:{type:String,default:""},titleIcon:{type:String,default:""},titleIconRadius:{type:String,default:""},subtitleText:{type:String,default:""},subtitleSize:{type:String,default:""},subtitleColor:{type:String,default:""},subtitleOverflow:{type:String,default:""},titleAlign:{type:String,default:""},backgroundImage:{type:String,default:""},backgroundRepeat:{type:String,default:""},blurEffect:{type:String,default:""},loading:{type:Boolean,default:!1},frontColor:{type:String,default:"#ffffff"},backgroundColor:{type:String,default:"#000000"},colorAnimationDuration:{type:Number,default:0},colorAnimationTimingFunc:{type:String,default:"linear"}},created(){const t=a(),e=t[t.length-1];this.__$page=e,this.$watch("title",(()=>{this.setNavigationBarTitle()})),this.$watch("loading",(()=>{this.setNavigationBarLoading()})),this.$watch((()=>[this.frontColor,this.backgroundColor,this.colorAnimationDuration,this.colorAnimationTimingFunc]),(()=>{this.setNavigationBarColor()}))},beforeMount(){this.title&&this.setNavigationBarTitle(),this.setNavigationBarLoading(),this.setNavigationBarColor()},methods:{setNavigationBarTitle(){i({__page__:this.__$page,title:this.title})},setNavigationBarLoading(){uni[(this.loading?"show":"hide")+"NavigationBarLoading"]({__page__:this.__$page})},setNavigationBarColor(){l({__page__:this.__$page,frontColor:this.frontColor,backgroundColor:this.backgroundColor,animation:{duration:this.colorAnimationDuration,timingFunc:this.colorAnimationTimingFunc}})},setTitleNView(t){const e=this.__$webview,a=e.getStyle();a&&a.titleNView&&e.setStyle({titleNView:t})}}},[["render",function(t,e,a,i,l,n){const u=o;return s(),r(u,{style:{display:"none"}})}]]);const V=P({name:"PageMeta",setup(t,{emit:e}){n((()=>{u((t=>{e("resize",t)}))}))},props:{backgroundTextStyle:{type:String,default:"dark",validator:t=>-1!==["dark","light"].indexOf(t)},backgroundColor:{type:String,default:"#ffffff"},backgroundColorTop:{type:String,default:"#ffffff"},backgroundColorBottom:{type:String,default:"#ffffff"},scrollTop:{type:String,default:""},scrollDuration:{type:Number,default:300},pageStyle:{type:String,default:""},enablePullDownRefresh:{type:[Boolean,String],default:!1},rootFontSize:{type:String,default:""}},created(){const t=a()[0];this.$pageVm=t.$vm||t,this.$watch("backgroundTextStyle",(()=>{this.setBackgroundTextStyle()})),this.$watch((()=>[this.rootFontSize,this.pageStyle]),(()=>{this.setPageMeta()})),this.$watch((()=>[this.backgroundColor,this.backgroundColorTop,this.backgroundColorBottom]),(()=>{this.setBackgroundColor()})),this.$watch((()=>[this.scrollTop,this.scrollDuration]),(()=>{this.pageScrollTo()}))},beforeMount(){this.setBackgroundColor(),(this.rootFontSize||this.pageStyle)&&this.setPageMeta(),this.backgroundTextStyle&&this.setBackgroundTextStyle()},mounted(){this.scrollTop&&this.pageScrollTo()},methods:{setPullDownRefresh(t,e){t.setStyle({pullToRefresh:{support:e,style:"Android"===plus.os.name?"circle":"default"}})},setPageMeta(){d({pageStyle:this.pageStyle,rootFontSize:this.rootFontSize})},setBackgroundTextStyle(){},setBackgroundColor(){},pageScrollTo(){let t=String(this.scrollTop);-1!==t.indexOf("rpx")&&(t=c(t.replace("rpx",""))),t=parseFloat(t),isNaN(t)||h({scrollTop:t,duration:this.scrollDuration,success:()=>{}})}}},[["render",function(t,e,a,i,l,n){const u=o;return s(),r(u,{style:{display:"none"}},{default:p((()=>[g(t.$slots,"default")])),_:3})}]]);const H=P({name:"uv-tabs",emits:["click","change"],mixins:[A,I,{props:{duration:{type:Number,default:300},list:{type:Array,default:()=>[]},lineColor:{type:String,default:"#3c9cff"},activeStyle:{type:[String,Object],default:()=>({color:"#303133"})},inactiveStyle:{type:[String,Object],default:()=>({color:"#606266"})},lineWidth:{type:[String,Number],default:20},lineHeight:{type:[String,Number],default:3},lineBgSize:{type:String,default:"cover"},itemStyle:{type:[String,Object],default:()=>({height:"44px"})},scrollable:{type:Boolean,default:!0},current:{type:[Number,String],default:0},keyName:{type:String,default:"name"},...null==(e=null==(t=uni.$uv)?void 0:t.props)?void 0:e.tabs}}],data:()=>({firstTime:!0,scrollLeft:0,scrollViewWidth:0,lineOffsetLeft:0,tabsRect:{left:0},innerCurrent:0,moving:!1}),watch:{current:{immediate:!0,handler(t,e){t!==this.innerCurrent&&(this.innerCurrent=t,this.$nextTick((()=>{this.resize()})))}},list(){this.$nextTick((()=>{this.resize()}))}},computed:{textStyle(){return t=>{const e={},a=t==this.innerCurrent?this.$uv.addStyle(this.activeStyle):this.$uv.addStyle(this.inactiveStyle);return this.list[t].disabled&&(e.color="#c8c9cc"),this.$uv.deepMerge(a,e)}},propsBadge:()=>j},async mounted(){this.init()},methods:{setLineLeft(){const t=this.list[this.innerCurrent];if(!t)return;let e=this.list.slice(0,this.innerCurrent).reduce(((t,e)=>t+e.rect.width),0),a=this.$uv.getPx(this.lineWidth);this.$uv.test.number(this.lineWidth)&&this.$uv.unit&&(a=this.$uv.getPx(`${this.lineWidth}${this.$uv.unit}`)),this.lineOffsetLeft=e+(t.rect.width-a)/2,this.firstTime&&setTimeout((()=>{this.firstTime=!1}),20)},animation(t,e=0){},clickHandler(t,e){this.$emit("click",{...t,index:e}),t.disabled||(this.innerCurrent!=e&&this.$emit("change",{...t,index:e}),this.innerCurrent=e,this.$nextTick((()=>{this.resize()})))},init(){this.$uv.sleep().then((()=>{this.resize()}))},setScrollLeft(){const t=this.list[this.innerCurrent],e=this.list.slice(0,this.innerCurrent).reduce(((t,e)=>t+e.rect.width),0),a=this.$uv.sys().windowWidth;let i=e-(this.tabsRect.width-t.rect.width)/2-(a-this.tabsRect.right)/2+this.tabsRect.left/2;i=Math.min(i,this.scrollViewWidth-this.tabsRect.width),this.scrollLeft=Math.max(0,i)},resize(){0!==this.list.length&&Promise.all([this.getTabsRect(),this.getAllItemRect()]).then((([t,e=[]])=>{this.tabsRect=t,this.scrollViewWidth=0,e.map(((t,e)=>{this.scrollViewWidth+=t.width,this.list[e].rect=t})),this.setLineLeft(),this.setScrollLeft()}))},getTabsRect(){return new Promise((t=>{this.queryRect("uv-tabs__wrapper__scroll-view").then((e=>t(e)))}))},getAllItemRect(){return new Promise((t=>{const e=this.list.map(((t,e)=>this.queryRect(`uv-tabs__wrapper__nav__item-${e}`,!0)));Promise.all(e).then((e=>t(e)))}))},queryRect(t,e){return new Promise((e=>{this.$uvGetRect(`.${t}`).then((t=>{e(t)}))}))}}},[["render",function(t,e,a,i,l,n){const u=x,d=W(f("uv-badge"),M),c=o,h=$;return s(),r(c,{class:"uv-tabs",style:_([t.$uv.addStyle(t.customStyle)])},{default:p((()=>[v(c,{class:"uv-tabs__wrapper"},{default:p((()=>[g(t.$slots,"left",{},void 0,!0),v(c,{class:"uv-tabs__wrapper__scroll-view-wrapper"},{default:p((()=>[v(h,{"scroll-x":t.scrollable,"scroll-left":l.scrollLeft,"scroll-with-animation":"",class:"uv-tabs__wrapper__scroll-view","show-scrollbar":!1,ref:"uv-tabs__wrapper__scroll-view"},{default:p((()=>[v(c,{class:"uv-tabs__wrapper__nav",ref:"uv-tabs__wrapper__nav",style:_({flex:t.scrollable?"":1})},{default:p((()=>[(s(!0),m(b,null,y(t.list,((e,a)=>(s(),r(c,{class:S(["uv-tabs__wrapper__nav__item",[`uv-tabs__wrapper__nav__item-${a}`,e.disabled&&"uv-tabs__wrapper__nav__item--disabled"]]),key:a,onClick:t=>n.clickHandler(e,a),ref_for:!0,ref:`uv-tabs__wrapper__nav__item-${a}`,style:_([{flex:t.scrollable?"":1},t.$uv.addStyle(t.itemStyle)])},{default:p((()=>[v(u,{class:S([[e.disabled&&"uv-tabs__wrapper__nav__item__text--disabled"],"uv-tabs__wrapper__nav__item__text"]),style:_([n.textStyle(a)])},{default:p((()=>[w(k(e[t.keyName]),1)])),_:2},1032,["class","style"]),v(d,{show:!(!e.badge||!(e.badge.show||e.badge.isDot||e.badge.value)),isDot:e.badge&&e.badge.isDot||n.propsBadge.isDot,value:e.badge&&e.badge.value||n.propsBadge.value,max:e.badge&&e.badge.max||n.propsBadge.max,type:e.badge&&e.badge.type||n.propsBadge.type,showZero:e.badge&&e.badge.showZero||n.propsBadge.showZero,bgColor:e.badge&&e.badge.bgColor||n.propsBadge.bgColor,color:e.badge&&e.badge.color||n.propsBadge.color,shape:e.badge&&e.badge.shape||n.propsBadge.shape,numberType:e.badge&&e.badge.numberType||n.propsBadge.numberType,inverted:e.badge&&e.badge.inverted||n.propsBadge.inverted,customStyle:"margin-left: 4px;"},null,8,["show","isDot","value","max","type","showZero","bgColor","color","shape","numberType","inverted"])])),_:2},1032,["onClick","style","class"])))),128)),v(c,{class:"uv-tabs__wrapper__nav__line",ref:"uv-tabs__wrapper__nav__line",style:_([{width:t.$uv.addUnit(t.lineWidth),transform:`translate(${l.lineOffsetLeft}px)`,transitionDuration:`${l.firstTime?0:t.duration}ms`,height:l.firstTime?0:t.$uv.addUnit(t.lineHeight),background:t.lineColor,backgroundSize:t.lineBgSize}])},null,8,["style"])])),_:1},8,["style"])])),_:1},8,["scroll-x","scroll-left"])])),_:1}),g(t.$slots,"right",{},void 0,!0)])),_:3})])),_:3},8,["style"])}],["__scopeId","data-v-da7392b4"]]),Z=P({__name:"npcItem",setup(t){const e=()=>{z()},a=C("");T((()=>{a.value=N().windowHeight,setTimeout((()=>{S(""),j("","")}),100)}));const i=C([{name:"饮料"},{name:"烹饪"},{name:"推荐"},{name:"符卡"},{name:"羁绊"}]),l=C(0),n=t=>{l.value=t.index},u=C(B("selectNpc")),d=C(B("drinksData")),c=C([]),h=C([]);d.value.forEach((t=>{h.value[t.chinese]=t}));const g=C(new Set),S=t=>{t&&(g.value.has(t)?g.value.delete(t):g.value.add(t)),c.value=d.value.filter((t=>{let e=t.tag.split(","),a=[...g.value].concat();return!(e.length<g.value.size)&&(e.forEach((t=>{a=a.filter((e=>e!==t.trim()))})),0===a.length)}))},x=C(B("cookData")),$=C([]),P=C([]);x.value.forEach((t=>{P.value[t.chinese]=t}));const A=C(new Set),I=C(new Set);u.value.noTag.split(",").forEach((t=>{I.value.add(t.trim())}));const j=(t,e)=>{e&&("tag"===t?A.value.has(e)?A.value.delete(e):A.value.add(e):I.value.has(e)?I.value.delete(e):I.value.add(e)),$.value=x.value.filter((t=>{let e=t.tag.split(","),a=[...A.value].concat();[...I.value].concat();let i=new Set;return!(e.length<A.value.size)&&(e.forEach((t=>{a=a.filter((e=>e!==t.trim())),I.value.forEach((e=>{e===t.trim()&&i.add(e)}))})),0===a.length&&0===i.size)})),Z()},M=C([]),Z=()=>{M.value.splice(0);let t=$.value.length<10?$.value.length:10;for(let e=0;e<t;e++)M.value.push($.value[e]);setTimeout((()=>{M.value=$.value}),100)};return(t,d)=>{const h=W(f("navigation-bar"),E),x=W(f("page-meta"),V),$=R,C=o,T=W(f("uv-tabs"),H),B=D,N=L;return s(),m(b,null,[v(x,null,{default:p((()=>[v(h,{title:"人物详情","background-color":"#8D6549"})])),_:1}),v(C,{class:"npc-item",style:_({height:a.value+"px"})},{default:p((()=>[v(C,{class:"npc-item-info",onClick:e},{default:p((()=>[v($,{src:"/static/img/npc/"+u.value.name+".png",style:{width:"100px",height:"130px","margin-right":"10px"},mode:"scaleToFill","lazy-load":"true"},null,8,["src"]),v(C,{class:"tag-div"},{default:p((()=>[v(C,{style:{margin:"0px","font-weight":"bold","font-size":"20px"}},{default:p((()=>[w(k(u.value.chinese),1)])),_:1}),v(C,null,{default:p((()=>[w("持有: "+k(u.value.money)+" 円",1)])),_:1}),v(C,{class:"tag-div-location"},{default:p((()=>[w("出没地区: "+k(u.value.location),1)])),_:1})])),_:1})])),_:1}),v(C,{class:"npc-item-tab",style:_({height:a.value-150+"px"})},{default:p((()=>[v(T,{list:i.value,current:l.value,onClick:n,scrollable:!1},null,8,["list","current"]),v(N,{circular:"",current:l.value,autoplay:!1,onChange:d[0]||(d[0]=t=>{l.value=t.detail.current}),style:_({height:a.value-200+"px"})},{default:p((()=>[v(B,null,{default:p((()=>[v(C,{class:"npc-item-tab-div",style:_({height:a.value-200+"px"})},{default:p((()=>[v(C,{class:"npc-item-tab-div-drinks-tag"},{default:p((()=>[(s(!0),m(b,null,y(u.value.drinks.split(","),(t=>(s(),r(C,{class:"drink-tag",key:t,onClick:e=>S(t.trim())},{default:p((()=>[w(" • "+k(t.trim())+" ",1),g.value.has(t.trim())?(s(),r(C,{key:0,class:"drink-tag-select"})):F("",!0)])),_:2},1032,["onClick"])))),128))])),_:1}),v(C,{class:"npc-item-tab-div-recommend-cook",style:_({height:a.value-280+"px"})},{default:p((()=>[(s(!0),m(b,null,y(c.value,(t=>(s(),r(C,{class:"npc-item-tab-div-cook-div-cook",key:t.name},{default:p((()=>[v(O,{type:"drink",isRecommand:!1,cookItem:t,cookFilter:g.value},null,8,["cookItem","cookFilter"])])),_:2},1024)))),128))])),_:1},8,["style"])])),_:1},8,["style"])])),_:1})])),_:1},8,["current","style"])])),_:1},8,["style"])])),_:1},8,["style"])],64)}}},[["__scopeId","data-v-bbaafa8d"]]);export{Z as default};
