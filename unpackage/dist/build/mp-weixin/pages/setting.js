"use strict";const e=require("../common/vendor.js"),o=require("../js/common.js");if(!Array){(e.resolveComponent("uv-notice-bar")+e.resolveComponent("uv-toast")+e.resolveComponent("uv-loading-page")+e.resolveComponent("uv-modal"))()}Math||((()=>"../uni_modules/uv-notice-bar/components/uv-notice-bar/uv-notice-bar.js")+(()=>"../uni_modules/uv-toast/components/uv-toast/uv-toast.js")+(()=>"../uni_modules/uv-loading-page/components/uv-loading-page/uv-loading-page.js")+(()=>"../uni_modules/uv-modal/components/uv-modal/uv-modal.js")+n+a)();const n=()=>"../components/tab-bar/tabBar.js",a=()=>"../components/GlobalChatButton/GlobalChatButton.js",t={__name:"setting",setup(n){const a=e.ref("关注Anon Tokyo喵，关注Anon Tokyo谢谢喵!!!!");e.reactive({npc:"npcData",npcRecommend:"npcData",location:"locationData",drink:"drinksData",cook:"cookData",matrial:"materialData",drinksTag:"drinkTagData",cookTag:"cookTagData"});const t=e.ref(!1),r=e.reactive({username:"",loggedIn:!1}),s=()=>{const o=e.index.getStorageSync("userInfo");o&&o.loggedIn?(t.value=!0,r.username=o.username,r.loggedIn=o.loggedIn):(t.value=!1,r.username="",r.loggedIn=!1)};e.watch(t,(e=>{e&&s()}));const l=()=>{e.index.navigateTo({url:"/pages/login"})},u=()=>{e.index.removeStorageSync("userInfo"),t.value=!1,r.username="",r.loggedIn=!1,l()};e.onShow((()=>{s()}));const c=e.ref(!1),i=e.ref(""),d=o=>{i.value.show({...o,complete(){o.url&&e.index.navigateTo({url:o.url})}})},m=e.ref(""),g=e.ref(""),v=e.ref(""),p=()=>{if(e.index.removeStorageSync("userInfo"),t.value=!1,r.username="",r.loggedIn=!1,"android"===f.value)try{plus.runtime.restart()}catch(o){e.index.reLaunch({url:"npc"})}},f=e.ref("");e.index.getSystemInfo({success:e=>{f.value=e.platform.toLowerCase(),console.log("getSystemInfo",e.platform.toLowerCase())},fail:e=>{console.log("getSystemInfo",e),d({type:"error",message:"getSystemInfo error!"+e,duration:2e3})}});return(n,s)=>e.e({a:e.p({text:a.value,color:"#830000"}),b:e.sr(i,"6d6f0b31-1",{k:"toast"}),c:t.value},t.value?{d:e.t(r.username),e:e.o(u)}:{f:e.o(l)},{g:e.o((e=>p())),h:e.o((e=>{"android"===f.value&&plus.runtime.restart()})),i:e.p({loading:c.value,"loading-text":"读取中...","font-size":"20px","loading-mode":"semicircle",bgColor:"#8D6549"}),j:e.sr(m,"6d6f0b31-3",{k:"clearCacheModal"}),k:e.o((n=>(e.index.clearStorageSync(),o.initCache(),d({type:"success",message:"缓存重置成功!",duration:500}),void p()))),l:e.p({content:"该操作会将所有数据重置!应用会自动重启!",showCancelButton:!0}),m:e.sr(v,"6d6f0b31-4",{k:"confirmModal"}),n:e.p({content:g.value}),o:e.p({selected:4})})}},r=e._export_sfc(t,[["__scopeId","data-v-6d6f0b31"]]);wx.createPage(r);
