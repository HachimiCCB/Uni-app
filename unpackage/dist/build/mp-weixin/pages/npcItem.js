"use strict";const e=require("../common/vendor.js");if(!Array){(e.resolveComponent("uv-tabs")+e.resolveComponent("uv-empty")+e.resolveComponent("uv-rate"))()}Math||((()=>"../uni_modules/uv-tabs/components/uv-tabs/uv-tabs.js")+a+(()=>"../uni_modules/uv-empty/components/uv-empty/uv-empty.js")+(()=>"../uni_modules/uv-rate/components/uv-rate/uv-rate.js"))();const a=()=>"../components/cookBar.js",t={__name:"npcItem",setup(a){const t=()=>{e.index.navigateBack()},l=e.ref("");e.nextTick$1((()=>{l.value=e.index.getSystemInfoSync().windowHeight,setTimeout((()=>{s(""),k("","")}),100)}));const o=e.ref([{name:"推荐"},{name:"烹饪"},{name:"饮料"},{name:"符卡"},{name:"羁绊"}]),n=e.ref(0),r=e=>{n.value=e.index},u=e.ref(e.index.getStorageSync("selectNpc")),v=e.ref(e.index.getStorageSync("drinksData")),i=e.ref([]),c=e.ref([]);v.value.forEach((e=>{c.value[e.chinese]=e}));const m=e.ref(new Set),s=e=>{e&&(m.value.has(e)?m.value.delete(e):m.value.add(e)),i.value=v.value.filter((e=>{let a=e.tag.split(","),t=[...m.value].concat();return!(a.length<m.value.size)&&(a.forEach((e=>{t=t.filter((a=>a!==e.trim()))})),0===t.length)}))},d=e.ref(e.index.getStorageSync("cookData")),p=e.ref([]),f=e.ref([]);d.value.forEach((e=>{f.value[e.chinese]=e}));const g=e.ref(new Set),h=e.ref(new Set);u.value.noTag.split(",").forEach((e=>{h.value.add(e.trim())}));const k=(e,a)=>{a&&("tag"===e?g.value.has(a)?g.value.delete(a):g.value.add(a):h.value.has(a)?h.value.delete(a):h.value.add(a)),p.value=d.value.filter((e=>{let a=e.tag.split(","),t=[...g.value].concat();[...h.value].concat();let l=new Set;return!(a.length<g.value.size)&&(a.forEach((e=>{t=t.filter((a=>a!==e.trim())),h.value.forEach((a=>{a===e.trim()&&l.add(a)}))})),0===t.length&&0===l.size)})),b()},x=e.ref([]),b=()=>{x.value.splice(0);let e=p.value.length<10?p.value.length:10;for(let a=0;a<e;a++)x.value.push(p.value[a]);setTimeout((()=>{x.value=p.value}),100)};return(a,v)=>{var d,p,b,C;return e.e({a:"/static/img/npc/"+u.value.name+".png",b:e.t(u.value.chinese),c:e.t(u.value.money),d:e.t(u.value.location),e:e.o(t),f:e.o(r),g:e.p({list:o.value,current:n.value,scrollable:!1}),h:!!u.value.recommendCooks},u.value.recommendCooks?{i:e.f(u.value.recommendCooks.split(","),((a,t,l)=>({a:"1e20e95b-1-"+l,b:e.p({type:"cook",isRecommand:!0,recommandCook:a.trim().split("*")[1],cookItem:f.value[a.trim().split("*")[0]],cookFilter:u.value.tag,cookNoFilter:u.value.noTag}),c:a})))}:{},{j:!u.value.recommendCooks},(u.value.recommendCooks,{}),{k:!!u.value.recommendDrinks},u.value.recommendDrinks?{l:e.f(u.value.recommendDrinks.split(","),((a,t,l)=>({a:"1e20e95b-2-"+l,b:e.p({type:"drink",isRecommand:!0,cookItem:c.value[a.trim().split("*")[0]],cookFilter:u.value.drinks}),c:a})))}:{},{m:!u.value.recommendDrinks},(u.value.recommendDrinks,{}),{n:l.value-200+"px",o:e.f(u.value.tag.split(","),((a,t,l)=>e.e({a:e.t(a.trim()),b:g.value.has(a.trim())},(g.value.has(a.trim()),{}),{c:a,d:e.o((e=>k("tag",a.trim())),a)}))),p:!!u.value.noTag},u.value.noTag?{q:e.f(u.value.noTag.split(","),((a,t,l)=>e.e({a:e.t(a.trim()),b:h.value.has(a.trim())},(h.value.has(a.trim()),{}),{c:a,d:e.o((e=>k("noTag",a.trim())),a)})))}:{},{r:e.f(x.value,((a,t,l)=>({a:"1e20e95b-3-"+l,b:e.p({type:"cook",isRecommand:!1,cookItem:a,cookFilter:g.value,cookNoFilter:u.value.noTag}),c:a.name}))),s:l.value-335+"px",t:l.value-200+"px",v:e.f(u.value.drinks.split(","),((a,t,l)=>e.e({a:e.t(a.trim()),b:m.value.has(a.trim())},(m.value.has(a.trim()),{}),{c:a,d:e.o((e=>s(a.trim())),a)}))),w:e.f(i.value,((a,t,l)=>({a:"1e20e95b-4-"+l,b:e.p({type:"drink",isRecommand:!1,cookItem:a,cookFilter:m.value}),c:a.name}))),x:l.value-280+"px",y:l.value-200+"px",z:!!(null==(d=u.value.rewardCard)?void 0:d.effect)},(null==(p=u.value.rewardCard)?void 0:p.effect)?{A:e.t(u.value.rewardCard.name),B:e.t(u.value.rewardCard.effect),C:e.t(u.value.punishCard.name),D:e.t(u.value.punishCard.effect)}:{E:e.p({text:"无符卡！",textColor:"#000",textSize:"20px",icon:"/static/img/common/no-card.png"})},{F:l.value-200+"px",G:(null==(b=u.value)?void 0:b.friendship.length)>0},(null==(C=u.value)?void 0:C.friendship.length)>0?{H:e.f(u.value.friendship,((a,t,l)=>({a:"1e20e95b-6-"+l,b:e.o((e=>a.name=e),a.name),c:e.p({activeIcon:"heart-fill",inactiveIcon:"heart",readonly:"",modelValue:a.name}),d:e.t(a.condition?a.condition:"无"),e:e.t("5"===a.name?"最终奖励：":"升级任务："),f:e.t(a.task),g:a.name})))}:{I:e.p({text:"无羁绊！",textColor:"#000",textSize:"20px",icon:"/static/img/common/no-friend.png",iconSize:"220"})},{J:l.value-200+"px",K:n.value,L:e.o((e=>{n.value=e.detail.current})),M:l.value-200+"px",N:l.value-150+"px",O:l.value+"px"})}}},l=e._export_sfc(t,[["__scopeId","data-v-1e20e95b"]]);wx.createPage(l);
